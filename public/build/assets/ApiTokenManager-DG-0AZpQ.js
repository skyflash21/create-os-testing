import{T as j,r as A,d as K,o as r,e as l,a as e,b as a,w as n,f as h,g as O,h as i,u,F as x,i as y,t as b,n as Q,p as W,j as X}from"./app-CIysMRTq.js";import{_ as Y}from"./ActionMessage-BOJgzwzx.js";import{_ as Z}from"./ActionSection-CAAzQpAQ.js";import{_ as q}from"./Checkbox-JuQYH_Bp.js";import{C as ee}from"./ConfirmationModal-BlZjVXlV.js";import{_ as te}from"./DangerButton-DIDu3C6p.js";import{_ as z}from"./DialogModal-BM-8Ao5i.js";import{_ as se}from"./FormSection-B5t2hfmx.js";import{_ as oe,a as ne}from"./TextInput-DTLETjzp.js";import{_ as B}from"./InputLabel-DQ6wkMAo.js";import{_ as S}from"./SecondaryButton-IGbTccb2.js";import{S as V}from"./SectionBorder-B2hvu3fD.js";import{C as w}from"./CustomButton-BjpqGt-I.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./SectionTitle-SdXdGDtx.js";import"./Modal-Cqho5cY5.js";const v=p=>(W("data-v-5c58bbbd"),p=p(),X(),p),ie={class:"mb-4"},re={class:"flex flex-row space-x-4"},le=O('<div class="w-1/2" data-v-5c58bbbd><h2 class="text-lg font-medium text-gray-900 dark:text-white" data-v-5c58bbbd>Utiliser les jetons API dans ComputerCraft</h2><p class="text-sm text-gray-500 dark:text-gray-400 mt-1" data-v-5c58bbbd> Les jetons API permettent aux ordinateurs dans Minecraft (mod ComputerCraft) de s&#39;authentifier auprès de notre application en votre nom. <br data-v-5c58bbbd><br data-v-5c58bbbd> Une fois un ordinateur chargé il va demander un jeton API pour pouvoir communiquer avec l&#39;application. <br data-v-5c58bbbd> Sans Jeton API, l&#39;ordinateur ne démarera pas. <br data-v-5c58bbbd><br data-v-5c58bbbd> Pour obtenir un jeton API, cliquez sur le bouton &quot;Créer un jeton API&quot; ci-dessous. <br data-v-5c58bbbd> Une fois le jeton créé, copiez-le et collez-le dans l&#39;ordinateur. <br data-v-5c58bbbd> Vous pouvez également gérer les jetons existants ci-dessous. <br data-v-5c58bbbd><br data-v-5c58bbbd><span class="text-red-500" data-v-5c58bbbd>Attention: Ne partagez jamais votre jeton API avec quiconque !</span><br data-v-5c58bbbd><br data-v-5c58bbbd> Sur la droite, vous pouvez voir l&#39;image que l&#39;ordinateur de ComputerCraft affichera lorsqu&#39;il demandera un jeton API. </p></div>',1),ce={class:"w-1/2"},de={class:"image-container"},ue=["src"],me=v(()=>e("br",null,null,-1)),pe=v(()=>e("br",null,null,-1)),_e=v(()=>e("br",null,null,-1)),be=v(()=>e("br",null,null,-1)),ve={class:"col-span-6 sm:col-span-4"},fe=v(()=>e("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},"Attention, le nom du jeton ne peut pas être modifié.",-1)),ge={key:0,class:"col-span-6"},ke={class:"mt-2"},he={class:"flex justify-between items-center"},xe={class:"text-lg font-medium text-gray-900 dark:text-white capitalize"},ye=["onClick"],Ce=["onClick"],Ae={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},we={class:"flex items-center"},Pe={class:"ms-2 text-sm text-gray-600 dark:text-gray-400"},Te={key:0},je={class:"mt-10 sm:mt-0"},Se={class:"space-y-6"},Ie={class:"break-all dark:text-white"},$e={class:"flex items-center ms-2"},qe={key:0,class:"text-sm text-gray-400"},ze=["onClick"],Be=["onClick"],Ve=v(()=>e("div",null,[e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Voici votre nouveau jeton API."),e("br"),e("p",{class:"text-red-500"},[i("Pour votre sécurité, il ne sera plus affiché."),e("br"),i("Assurez-vous de le copier maintenant.")])],-1)),Fe=v(()=>e("label",{class:"block font-medium text-sm text-gray-700 dark:text-gray-200 mt-4"},"Token",-1)),Ne={key:0,class:"bg-gray-100 dark:bg-gray-900 px-4 py-2 rounded font-mono text-sm text-gray-500 break-all",id:"token_field"},Ue=v(()=>e("label",{class:"block font-medium text-sm text-gray-700 dark:text-gray-200 mt-4"},"Commande wget",-1)),Ee={key:1,class:"bg-gray-100 dark:bg-gray-900 px-4 py-2 rounded font-mono text-sm text-gray-500 break-all",id:"command_field"},Re={class:"flex justify-between items-center"},Me={class:"text-lg font-medium text-gray-900 dark:text-white capitalize"},De=["onClick"],Je=["onClick"],Le={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ge={class:"flex items-center"},He={class:"ms-2 text-sm text-gray-600 dark:text-gray-400"},Ke={__name:"ApiTokenManager",props:{tokens:Array,availablePermissions:Array,defaultPermissions:Array},setup(p){const I=p,c=j({name:"",permissions:I.defaultPermissions}),_=j({permissions:[]}),P=j({}),C=A(!1),f=A(null),g=A(null),$=()=>{c.post(route("api-tokens.store"),{preserveScroll:!0,onSuccess:()=>{C.value=!0,c.reset()}})},F=()=>{const o=document.getElementById("token_field"),s=document.createRange();s.selectNode(o),window.getSelection().removeAllRanges(),window.getSelection().addRange(s),document.execCommand("copy"),window.getSelection().removeAllRanges();const t=document.getElementById("copy_token_button");t.innerText="Token copié",setTimeout(()=>{t.innerText="Copier le token"},2e3)},N=()=>{const o=document.getElementById("command_field"),s=document.createRange();s.selectNode(o),window.getSelection().removeAllRanges(),window.getSelection().addRange(s),document.execCommand("copy"),window.getSelection().removeAllRanges();const t=document.getElementById("copy_command_button");t.innerText="Commande copiée",setTimeout(()=>{t.innerText="Copier la commande"},2e3)},U=o=>{_.permissions=o.abilities,f.value=o},E=()=>{_.put(route("api-tokens.update",f.value),{preserveScroll:!0,preserveState:!0,onSuccess:()=>f.value=null})},R=o=>{g.value=o},M=()=>{P.delete(route("api-tokens.destroy",g.value),{preserveScroll:!0,preserveState:!0,onSuccess:()=>g.value=null})},k=K(()=>{const o={};return I.availablePermissions.forEach(s=>{const[t,d]=s.split(":");o[t]||(o[t]=[]),o[t].push(s)}),o}),D=o=>{k.value[o].forEach(t=>{c.permissions.includes(t)||c.permissions.push(t)})},J=o=>{c.permissions=c.permissions.filter(s=>!k.value[o].includes(s))},L=o=>{k.value[o].forEach(t=>{_.permissions.includes(t)||_.permissions.push(t)})},G=o=>{_.permissions=_.permissions.filter(s=>!k.value[o].includes(s))},H=A("/storage/images/computer_craft_token.png");return(o,s)=>(r(),l("div",null,[e("div",ie,[e("div",re,[le,e("div",ce,[e("div",de,[e("img",{src:H.value,alt:"ComputerCraft Image"},null,8,ue)])])])]),a(V),a(se,{onSubmitted:$},{title:n(()=>[i(" Créer un jeton API ")]),description:n(()=>[i(" Les jetons sont des clés permettant à des services tiers de s'authentifier auprès de l'application. "),me,pe,i(" Ils sont uniques et possèdent des permissions spécifiques. "),_e,be,i(" Le menu sur la droite permet de créer un jeton avec des permissions spécifiques. ")]),form:n(()=>[e("div",ve,[a(B,{for:"name",value:"Nom"}),fe,a(oe,{id:"name",modelValue:u(c).name,"onUpdate:modelValue":s[0]||(s[0]=t=>u(c).name=t),type:"text",class:"mt-1 block w-full",autofocus:""},null,8,["modelValue"]),a(ne,{message:u(c).errors.name,class:"mt-2"},null,8,["message"])]),p.availablePermissions.length>0?(r(),l("div",ge,[a(B,{for:"permissions",value:"Permissions"}),e("div",ke,[(r(!0),l(x,null,y(k.value,(t,d)=>(r(),l("div",{key:d,class:"mb-4"},[e("div",he,[e("h3",xe,b(d.replace("_"," ")),1),e("div",null,[e("button",{type:"button",class:"text-sm text-blue-500 underline mr-2",onClick:m=>D(d)}," Tout cocher ",8,ye),e("button",{type:"button",class:"text-sm text-blue-500 underline",onClick:m=>J(d)}," Tout décocher ",8,Ce)])]),e("div",Ae,[(r(!0),l(x,null,y(t,m=>(r(),l("div",{key:m},[e("label",we,[a(q,{checked:u(c).permissions,"onUpdate:checked":T=>u(c).permissions=T,value:m},null,8,["checked","onUpdate:checked","value"]),e("span",Pe,b(m.split(":")[1]),1)])]))),128))])]))),128))])])):h("",!0)]),actions:n(()=>[a(Y,{on:u(c).recentlySuccessful,class:"me-3"},{default:n(()=>[i(" Créé. ")]),_:1},8,["on"]),a(w,{type:"primary",disabled:u(c).processing,onClick:$,class:"ms-auto"},{default:n(()=>[i(" Créer un jeton API ")]),_:1},8,["disabled"])]),_:1}),p.tokens.length>0?(r(),l("div",Te,[a(V),e("div",je,[a(Z,null,{title:n(()=>[i(" Gérer les jetons API ")]),description:n(()=>[i(" Chaque jeton que vous créez peut être supprimé à tout moment si vous pensez qu'il a été compromis ou s'il n'est plus nécessaire. ")]),content:n(()=>[e("div",Se,[(r(!0),l(x,null,y(p.tokens,t=>(r(),l("div",{key:t.id,class:"flex items-center justify-between"},[e("div",Ie,b(t.name),1),e("div",$e,[t.last_used_ago?(r(),l("div",qe," Dernière utilisation "+b(t.last_used_ago),1)):h("",!0),p.availablePermissions.length>0?(r(),l("button",{key:1,class:"cursor-pointer ms-6 text-sm text-gray-400 underline",onClick:d=>U(t)}," Permissions ",8,ze)):h("",!0),e("button",{class:"cursor-pointer ms-6 text-sm text-red-500",onClick:d=>R(t)}," Supprimer ",8,Be)])]))),128))])]),_:1})])])):h("",!0),a(z,{show:C.value,onClose:s[2]||(s[2]=t=>C.value=!1)},{title:n(()=>[i(" Jeton API ")]),content:n(()=>[Ve,Fe,o.$page.props.jetstream.flash.token?(r(),l("div",Ne,b(o.$page.props.jetstream.flash.token),1)):h("",!0),a(w,{onClick:F,id:"copy_token_button",type:"primary"},{default:n(()=>[i(" Copier le token ")]),_:1}),Ue,o.$page.props.jetstream.flash.token?(r(),l("div",Ee," wget run http://127.0.0.1:8000/api/startup "+b(o.$page.props.jetstream.flash.token),1)):h("",!0),a(w,{onClick:N,id:"copy_command_button",type:"primary"},{default:n(()=>[i(" Copier la commande ")]),_:1})]),footer:n(()=>[a(S,{onClick:s[1]||(s[1]=t=>C.value=!1)},{default:n(()=>[i(" Fermer ")]),_:1})]),_:1},8,["show"]),a(z,{show:f.value!=null,onClose:s[4]||(s[4]=t=>f.value=null)},{title:n(()=>[i(" Permissions du Jeton API ")]),content:n(()=>[(r(!0),l(x,null,y(k.value,(t,d)=>(r(),l("div",{key:d,class:"mb-4"},[e("div",Re,[e("h3",Me,b(d.replace("_"," ")),1),e("div",null,[e("button",{type:"button",class:"text-sm text-blue-500 underline mr-2",onClick:m=>L(d)}," Tout cocher ",8,De),e("button",{type:"button",class:"text-sm text-blue-500 underline",onClick:m=>G(d)}," Tout décocher ",8,Je)])]),e("div",Le,[(r(!0),l(x,null,y(t,m=>(r(),l("div",{key:m},[e("label",Ge,[a(q,{checked:u(_).permissions,"onUpdate:checked":T=>u(_).permissions=T,value:m},null,8,["checked","onUpdate:checked","value"]),e("span",He,b(m.split(":")[1]),1)])]))),128))])]))),128))]),footer:n(()=>[a(S,{onClick:s[3]||(s[3]=t=>f.value=null)},{default:n(()=>[i(" Annuler ")]),_:1}),a(w,{type:"primary",disabled:u(_).processing,onClick:E,class:"ms-3"},{default:n(()=>[i(" Mettre à jour ")]),_:1},8,["disabled"])]),_:1},8,["show"]),a(ee,{show:g.value!=null,onClose:s[6]||(s[6]=t=>g.value=null)},{title:n(()=>[i(" Supprimer le Jeton API ")]),content:n(()=>[i(" Êtes-vous sûr de vouloir supprimer ce jeton API ? ")]),footer:n(()=>[a(S,{onClick:s[5]||(s[5]=t=>g.value=null)},{default:n(()=>[i(" Annuler ")]),_:1}),a(te,{class:Q(["ms-3",{"opacity-25":u(P).processing}]),disabled:u(P).processing,onClick:M},{default:n(()=>[i(" Supprimer ")]),_:1},8,["class","disabled"])]),_:1},8,["show"])]))}},dt=ae(Ke,[["__scopeId","data-v-5c58bbbd"]]);export{dt as default};
